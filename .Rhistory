rm(list=ls())
url <- function(address, return.call = "json", sensor = "false") {
root <- "https://maps.googleapis.com/maps/api/geocode/"
u <- paste(root, return.call, "?address=", address, "&sensor=", sensor, sep = "")
return(URLencode(u))
}
geoCode <- function(address,verbose=FALSE) {
if(verbose) cat(address,"\n")
u <- url(address)
doc <- getURL(u)
x <- fromJSON(doc,simplify = FALSE)
if(x$status=="OK") {
lat <- x$results[[1]]$geometry$location$lat
lng <- x$results[[1]]$geometry$location$lng
location_type <- x$results[[1]]$geometry$location_type
formatted_address <- x$results[[1]]$formatted_address
return(c(lat, lng, location_type, formatted_address))
Sys.sleep(0.5)
} else {
return(c(NA,NA,NA,NA))
}
}
# Use plyr to ggeocoding for a vector
address <- c("The White House, Washington, DC", "The Capitol, Washington, DC")
locations <- ldply(address, function(x) geoCode(x))
names(locations) <- c("lat", "lon", "location_type", "formatted")
head(locations)
address
library(cartography)
rootdir="C:/Users/Silvio/Documents/GitHub/"
rootdir1="C:/Users/Silvio/Documents/"
rootdir2="C:/Users/Silvio/Documents/ArcGIS Explorer/My Basemaps/"
mapdir1="U-of-Florida-Yucatan-Project/Shapefiles/"
mapdir3="ArcGIS Explorer/My Basemaps/MEX_adm/"
mapdir2="encuesta_intercensal_2015 Diego/encuesta_intercensal_2015/shps/yuc/"
setwd(paste0(rootdir,"U-of-Florida-Yucatan-Project"))
# install.packages("cluster")
library(cluster)
# install.packages("dplyr")
library(dplyr)
py<- read.table(paste0(rootdir1,"R/Yucatan-Project/pop-yucatan/population-yucatan-silvio.txt"),header = T)
ly<-read.table(paste0(rootdir1,"R/Yucatan-Project/pop-yucatan/locations-yucatan-silvio.txt"),header=T)
ly$hid=ly$id
ly$workid=ly$id
py=left_join(py,ly[,c("hid","x","y")],by="hid")#adding 2 columns in py (after workid) with house x y coordinates
py=left_join(py,ly[,c("workid","x","y")],by="workid")
colnames(py)<-c("pid","hid","age","sex","hh_serial","pernum","workid","x1","y1","x2","y2")
students=py[py$age>4 & py$age<18,]
schools = ly[ly$type=='school',]
rootdir1
rootdir1
rootdir="C:/Users/Silvio/Documents/GitHub/"
setwd(paste0(rootdir,"U-of-Florida-Yucatan-Project"))
################################################
#########Py new data########################
py<- read.table("Linux Data/pop-yucatan/population-yucatan-silvio.txt",header = T)
ly<-read.table("Linux Data/pop-yucatan/locations-yucatan-silvio.txt",header=T)
ly$hid=ly$id
ly$workid=ly$id
py=left_join(py,ly[,c("hid","x","y")],by="hid")#adding 2 columns in py (after workid) with house x y coordinates
py=left_join(py,ly[,c("workid","x","y")],by="workid")
colnames(py)<-c("pid","hid","age","sex","hh_serial","pernum","workid","x1","y1","x2","y2")
students=py[py$age>4 & py$age<18,]
schools = ly[ly$type=='school',]
130/7330
130/6106
144+564+2123+277
923+1641
923+1641+1148
67/3712
.018*3712
3010+795
3010+795+385
3010+795+360+40
3010+795+385+40
456+3010+795
40+385+360+37+332+54
.133*4261
33+419+113
565/4261
.115*1208
140/1208
.116*1208
.132*4261
.089*4193
373/4193
177+601+164
18+59+17
94/942
.0998*942
