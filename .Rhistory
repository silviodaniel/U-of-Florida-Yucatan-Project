i=2001
grepl(i,head(denmelt[,4]))
denmelt[,4]==grepl(i,head(denmelt[,4]))
grepl(i,head(denmelt[,4]))==T
grepl(i,(denmelt[,4]))==T
denmelt[,4][grepl('2001',denmelt[,4])]
denmelt[,5][grepl('2001',denmelt[,4])]
denmelt[,4][grepl('2001',denmelt[,4])]#How to output biweeks; use grepl to check if column contains
length(denmelt[,4][grepl('2001',denmelt[,4])])#How to output biweeks; use grepl to check if column contains
length(denmelt[,5][grepl('2001',denmelt[,4])])#How to output biweeks; use grepl to check if column contains
length(denmelt[,4][grepl('2001',denmelt[,4])])#How to output biweeks; use grepl to check if column contains
denmelt[,4][grepl('2001',denmelt[,4])]
length(denmelt[,5][grepl('2001',denmelt[,4])])#How to output biweeks; use grepl to check if column contains
denmelt[,5][grepl('2001',denmelt[,4])]
denmelt[,5][grepl('2001',denmelt[,4])]
denmelt[grepl('2001',denmelt[,4])]#How to output biweeks; use grepl to check if column contains
grepl('2001',denmelt[,4])#How to output biweeks; use grepl to check if column contains
print(grepl('2001',denmelt[,4]))#How to output biweeks; use grepl to check if column contains
reg=-12.35+.4972*26.3
e^reg/(1+e^reg)
e^reg/(1+e^reg)
reg=-12.35+.4972*26.3;reg
e^reg
exp(reg)/(1+exp(reg))
pi=exp(reg)/(1+exp(reg));pi#.674
odds=pi/(1-pi)
odds=pi/(1-pi);odds
exp(-12.35)*(exp(.4972))^26.3
qnorm(1-.05/2)
z=qnorm(1-.05/2)
a=.05
pi=.095
n=(z^2*pi*(1-pi)/a^2);n
pi=.085
n=(z^2*pi*(1-pi)/a^2);n
133+119
sqrt(.6*.4)
a=.05
z=qnorm(1-.05/2)
pi=.6
n=(z^2*pi*(1-pi)/a^2);n
a=.8
z=qnorm(1-.05/2)
pi=.6
n=(z^2*pi*(1-pi)/a^2);n
a=.05
z=qnorm(1-.05/2)
pi=.6
n=(z^2*pi*(1-pi)/a^2);n
n=(pi*(1-pi)/a^2);n
pi=.10
n=(pi*(1-pi)/a^2);n
pi=.095
n=(pi*(1-pi)/a^2);n
a=.05
z=qnorm(1-.05/2)
pi=.6
n=(z^2*pi*(1-pi)/a^2);n
a=.2
z=qnorm(1-.05/2)
pi=.6
n=(z^2*pi*(1-pi)/a^2);n
z
pi=.6
n=(z^2*pi*(1-pi)/a^2);n
a=.05
pi=.095
n=(pi*(1-pi)/a^2);n
pi=.6
n=(pi*(1-pi)/a^2);n
pi=.5
a=.1
z=qnorm(1-.05/2)
pi=.5
n=(z^2*pi*(1-pi)/a^2);n
head(denmelt)
grepl(i,head(denmelt[,4]))
denmelt[,4][grepl(i,head(denmelt[,4]))]
denmelt[,4][grepl(i,(denmelt[,4]))]
library(dplyr)
format(denmelt$Date,"%Y")
str(format)
?format
format(denmelt$Date,format="%Y")
summary(denmelt)
format(as.Date(as.character(denmelt$Date)),format="%Y")
denmelt %>%
mutate( year = format(as.Date(as.character(Date)),format="%Y") ) %>%
group_by( Province, year ) %>%
filter( value==max(value) )
denmelt %>% head
denmelt %>%
mutate( year = format(as.Date(as.character(date1)),format="%Y") ) %>%
group_by( Province, year ) %>%
filter( value==max(value) )
denmelt %>%
mutate( year = format(as.Date(as.character(date1)),format="%Y") ) %>% head
head(denmelt)
colnames(denmelt)
denmelt %>% head
den=as.data.frame(t(brazil.incidence))
den$week=rownames(den)
denmelt=melt(den,id.vars="week")
date1 = (as.Date(as.integer(as.character(denmelt$week)),origin="1970-01-01"))
date1=as.data.frame(date1)
denmelt$Date=date1#;View(df_melt)#adding date to data frame to view
denmelt[,4]=sapply(denmelt[,4],as.character)
denmelt$Biweek=(ceiling(lubridate::week(ymd(denmelt[,4]))/2))
View(denmelt)
denmelt %>% head
head(denmelt$Date)
den=as.data.frame(t(brazil.incidence))
den$week=rownames(den)
denmelt=melt(den,id.vars="week")
date1 = (as.Date(as.integer(as.character(denmelt$week)),origin="1970-01-01"))
denmelt$Date=date1#;View(df_melt)#adding date to data frame to view
denmelt[,4]=sapply(denmelt[,4],as.character)
denmelt$Biweek=(ceiling(lubridate::week(ymd(denmelt[,4]))/2))
View(denmelt)
denmelt %>% head
denmelt %>%
mutate( year = format(as.Date(as.character(Date)),format="%Y") ) %>%
group_by( Province, year ) %>%
filter( value==max(value) )
denmelt %>% head
denmelt %>% head
denmelt %>%
mutate( year = format(as.Date(as.character(Date)),format="%Y") ) %>%
group_by( variable, year ) %>%
filter( value==max(value) )
with(
denmelt %>%
mutate( year = format(as.Date(as.character(Date)),format="%Y") ) %>%
group_by( variable, year ) %>%
filter( value==max(value) )
, hist(Biweek)
)
str(by)
denmelt %>%
mutate( year = format(as.Date(as.character(Date)),format="%Y") ) %>%
rename( location = variable ) %>% head
denmelt %>%
mutate( year = format(as.Date(as.character(Date)),format="%Y") ) %>%
rename( location = variable ) %>% head
str(by)
?hist
by(
denmelt.maxbiweek <- denmelt %>%
mutate( year = format(as.Date(as.character(Date)),format="%Y") ) %>%
rename( location = variable ) %>% head
group_by( location , year ) %>%
filter( value==max(value) )
, denmelt.maxbiweek$location
, function(df){
with(df, hist(Biweek,breaks = 0:27))
}
)
by(
denmelt.maxbiweek <- denmelt %>%
mutate( year = format(as.Date(as.character(Date)),format="%Y") ) %>%
rename( location = variable ) %>%
group_by( location , year ) %>%
filter( value==max(value) )
, denmelt.maxbiweek$location
, function(df){
with(df, hist(Biweek,breaks = 0:27))
}
)
by(
denmelt.maxbiweek <- denmelt %>%
mutate( year = format(as.Date(as.character(Date)),format="%Y") ) %>%
rename( location = variable ) %>%
group_by( location , year ) %>%
filter( value==max(value) )
, denmelt.maxbiweek$location
, function(df){
with(df, hist(Biweek,breaks = 0:27, main=location[1]))
}
)
library(ggplot2)
facet_wrap
ggplot(
denmelt.maxbiweek <- denmelt %>%
mutate( year = format(as.Date(as.character(Date)),format="%Y") ) %>%
rename( location = variable ) %>%
group_by( location , year ) %>%
filter( value==max(value) )
,aes(x=Biweek))+
geom_histogram(binwidth = 1)+
facet_wrap(~location,nrow=5)
mode
denmelt %>%
mutate( year = format(as.Date(as.character(Date)),format="%Y") ) %>%
rename( location = variable ) %>%
group_by( location , year ) %>%
filter( value==max(value) ) %>%
group_by( location ) %>%
mutate( MaxBiweek = Biweek == mode(Biweek) )
denmelt %>%
mutate( year = format(as.Date(as.character(Date)),format="%Y") ) %>%
rename( location = variable ) %>%
group_by( location , year ) %>%
filter( value==max(value) ) %>%
group_by( location ) %>%
mutate( MaxBiweek = Biweek == mode(Biweek) )
denmelt %>%
mutate( year = format(as.Date(as.character(Date)),format="%Y") ) %>%
rename( location = variable ) %>%
group_by( location , year ) %>%
filter( value==max(value) ) %>%
group_by( location ) %>%
mutate( MaxBiweek = Biweek == mode(Biweek) ) %>%
arrange(MaxBiweek)
denmelt %>%
mutate( year = format(as.Date(as.character(Date)),format="%Y") ) %>%
rename( location = variable ) %>%
group_by( location , year ) %>%
filter( value==max(value) ) %>%
group_by( location ) %>%
mutate( MaxBiweek = Biweek == mode(Biweek) ) %>%
arrange(desc(MaxBiweek))
denmelt %>%
mutate( year = format(as.Date(as.character(Date)),format="%Y") ) %>%
rename( location = variable ) %>%
group_by( location , year ) %>%
filter( value==max(value) ) %>%
group_by( location ) %>%
mutate( MaxBiweek = Biweek == mode(Biweek) ) %>%
summary
mode(c('a','b','c','c'))
8.315*310*log(1/100000)+1*96480*(-.07)
8.315*310*log(100000)+1*96480*(-.07)
Remission <-
read.table("http://www.stat.ufl.edu/~aa/cat/data/Remission.dat",
header=TRUE)
Remission
attach(Remission)
Remission
fit <- glm(remissions/cases ~ LI, family=binomial,
weights=cases)
summary(fit)
confint(fit)
fit$coef
pix(bhat,x=8) #.06797
pix <- function(bvec,x)
{ eta <- t(bvec) %*% c(1,x)
exp(eta)/(1+exp(eta))
}
bhat <- fit$coef
pix(bhat,x=8) #.06797
pix(bhat,x=26.0) # ,4973
-bhat[1]/bhat[2] # 26.074
Crabs <- read.table(
"http://www.stat.ufl.edu/~aa/cat/data/Crabs.dat",header=T)
Crabs[1:3,]
attach(Crabs)
plot(jitter(y,0.08) ~ width)
fit <- glm(y ~ width, family=binomial)
attach(Crabs)
.14486/.05934
(-2.579)^2
x=0
pi= 0.0025476+0.0010872*x
pi= 0.0025476+0.0010872*x;pi
x=0
pi= 0.0025476+0.0010872*x;pi
x=4
pi= 0.0025476+0.0010872*x;pi
x=0
pi= 0.0025476+0.0010872*x;pi#Probability for x=0
pi0=pi
x=4
pi= 0.0025476+0.0010872*x;pi#Probability for x=0
pi4=pi
pi0
pi4
pi0/pi4
pi4/pi0
x=0
pi0=-5.9605+0.3166*x;pi0
x=4
pi4=-5.9605+0.3166*x;pi4
pi4/p0
pi4/pi0
OR=exp(.3166);OR#Odds ratio
6.2020-1.9487
LR=6.2020-1.9487;LR
pchisq(LR, 1, lower.tail=F)
D=0;V=1
pi=- 3.5961- 0.8678*D+ 2.4044*V;pi
D
V
x=0
pi4=exp(-5.9605+0.3166*x)/(1+exp(-5.9605+0.3166*x));pi4
pi=exp(- 3.5961- 0.8678*D+ 2.4044*V)/(1+exp(- 3.5961- 0.8678*D+ 2.4044*V));pi
D=1;V=1
pi=exp(- 3.5961- 0.8678*D+ 2.4044*V)/(1+exp(- 3.5961- 0.8678*D+ 2.4044*V));pi
D=0;V=1
pi=exp(- 3.5961- 0.8678*D+ 2.4044*V)/(1+exp(- 3.5961- 0.8678*D+ 2.4044*V));pi
D=0;V=0
pi=exp(- 3.5961- 0.8678*D+ 2.4044*V)/(1+exp(- 3.5961- 0.8678*D+ 2.4044*V));pi
D=1;V=0
pi=exp(- 3.5961- 0.8678*D+ 2.4044*V)/(1+exp(- 3.5961- 0.8678*D+ 2.4044*V));pi
D=0;V=1
pi=exp(- 3.5961- 0.8678*D+ 2.4044*V)/(1+exp(- 3.5961- 0.8678*D+ 2.4044*V));pi
x=0
pi0=exp(-5.9605+0.3166*x)/(1+exp(-5.9605+0.3166*x));pi0
x=4
pi4=exp(-5.9605+0.3166*x)/(1+exp(-5.9605+0.3166*x));pi4
pi4/pi0
OR=exp(.3166);OR#Odds ratio
D=0;V=1
pi=exp(-3.5961 -0.8678*D +2.4044*V)/(1+exp(-3.5961 -0.8678*D +2.4044*V));pi
y=1+2x
reg=lm(y~x)
y
x
y=c(0,1,2,3,4,5)
x=c(0,1,2,3,4,5)
y=c()
y=c(0,2,4,6,8,10)
reg=lm(y~x)
plot(reg)
plot(x,y)
anova(reg)
chisq.test(reg)
reg=lm(y~x)
plot(reg)
plot(x,y)
anova(reg)
summary(reg)
abline(reg)
plot(x,y)
abline()
plot(x,y)
y=c(20,60,46,41,12,137,68,89,4,32,144,156,93,36,72,100,105,131,127,57,66,101,109,74,134,112,18,73,111,96,123,90,20,28,3,57,86,132,112,27,131,34,27,61,77)
x=c(2,4,3,2,1,10,5,5,1,2,9,10,6,3,4,8,7,8,10,4,5,7,7,5,9,7,2,5,7,6,8,5,2,2,1,4,5,9,7,1,9,2,2,4,5)
yh=-.5802+15.0352*x
reg=lm(y~x)
reg=lm(y~x)
summary(reg)
plot(reg)
plot(x,y)
abline(reg)
plot(x,y)
x=c(0,1,2,3,4,5)
y=c(0,2,4,6,8,10)
reg=lm(y~x)
abline(reg)
plot(x,y)
abline(reg)
x2=c(0,3,6,9,12,15)
y=c(0,2,4,6,8,10)
reg=lm(y~x)
plot(x,y)
abline(reg)
reg=lm(y~x+x2)
summary(reg)
x2
x=c(0,1,2,3,4,5)
x2=c(0,3,6,9,12,15)
y=c(0,2,4,6,8,10)
reg=lm(y~x+x2)
summary(reg)
reg=lm(y~x+x2)
abline(reg)
q()
data.frame(Race=rep(c("W","B"),c(2,2)), AZT=rep(c("Y","N"),2),Y=c(14,32,11,12),
N=c(93,81,52,43))
Malform=data.frame( Alcoholic_Drinks=c(0,.5,1.5,4,7),Absent=c(17066,14464,788,126,37),Present=c(48,38,5,1,1));Malform
Malform$n=rowSums(Malform[2:3])
fit=glm(Malform$Present/Malform$n ~ Malform$Alcoholic_Drinks,family=binomial(link=logit),weights=Malform$n)
summary(fit)
DeathPenalty <-
read.table("http://www.stat.ufl.edu/˜aa/cat/data/DeathPenalty.dat",
header=TRUE)
DeathPenalty <-
read.table("http://www.stat.ufl.edu/~aa/cat/data/DeathPenalty.dat",
header=TRUE)
DeathPenalty
Malform=data.frame( Alcoholic_Drinks=c(0,.5,1.5,4,7),Absent=c(17066,14464,788,126,37),Present=c(48,38,5,1,1));Malform
DeathPenalty
rep(1,0,by=2)
rep(1,0,each=2)
rep(c(1,0),each=2)
rep(c(1,0),by=2)
seq(c(1,0),by=2)
rep(c(1,0),each=2)
rep(c(0,0,1),times=3)
rep(c(0,0,1),each=3)
rep(c(1,0),times=2)
rep(c(1,0),times=2)
rep(c(1,0),each=2)
DeathPenalty
DeathPenalty$count
DeathPenalty[1:2]
DeathPenalty$count[1:2]
DeathPenalty$count[1:8,2]
DeathPenalty$count[1:8,by=2]
seq(1:8,by=2)
seq(1:8)
seq(1:8,each=2)
seq(1:8,2)
?seq()
seq(1,8,by=2)
seq(0,8,by=2)
DeathPenalty
seq(1,8,by=2)
DeathPenalty$count[seq(1,8,by=2)]
Yes=DeathPenalty$count[seq(1,8,by=2)]
DeathPenalty$count[seq(0,8,by=2)]
No=DeathPenalty$count[seq(0,8,by=2)]
,Y=Yes,N=No);DeathPenalty1
DeathPenalty1=data.frame(D=rep(c(1,0),times=2),V=rep(c(1,0),each=2)
,Y=Yes,N=No);DeathPenalty1
Malform=data.frame( Alcoholic_Drinks=c(0,.5,1.5,4,7),Absent=c(17066,14464,788,126,37),Present=c(48,38,5,1,1));Malform
Malform$n=rowSums(Malform[2:3])
Malform
DeathPenalty
DeathPenalty1
rowSums(DeathPenalty1[1:4])
rowSums(DeathPenalty1[2:3,1:4])
rowSums(DeathPenalty1[,3:4])
DeathPenalty1$n=rowSums(DeathPenalty1[,3:4])
DeathPenalty1
Malform
DeathPenalty1
DeathPenalty1$V
fit=glm(DeathPenalty1$Y/DeathPenalty1$n ~ DeathPenalty1$D+DeathPenalty1$V,family=binomial(link=logit),weights=DeathPenalty1$n)
summary(fit)
SoreThroat <-
read.table("http://www.stat.ufl.edu/~aa/cat/data/SoreThroat.dat",
skip=5, header=TRUE)
SoreThroat
library(pROC)
Crabs <- read.table("http://www.stat.ufl.edu/~aa/cat/data/Crabs.dat",header=T)
y=Crabs$y;y
weight=Crabs$weight
tail(Crabs)
fit=glm(y~weight,family=binomial)
sum(Crabs$y)/length(Crabs$y)
predicted=rep(0,173)
predicted[fitted(fit)>.642]=1
table_Crabs=table(Crabs$y,predicted);table_Crabs
sens=table_Crabs[2,2]/(table_Crabs[2,2]+table_Crabs[2,1]);sens#.613
spec=table_Crabs[1,1]/(table_Crabs[1,1]+table_Crabs[1,2]);spec#.726
Crabs
DeathPenalty <-
read.table("http://www.stat.ufl.edu/~aa/cat/data/DeathPenalty.dat",
header=TRUE);DeathPenalty
DeathPenalty$count
Yes=DeathPenalty$count[seq(1,8,by=2)]
No=DeathPenalty$count[seq(0,8,by=2)]
DeathPenalty1=data.frame(D=rep(c(1,0),times=2),V=rep(c(1,0),each=2)
,Y=Yes,N=No)
DeathPenalty1$n=rowSums(DeathPenalty1[,3:4]);DeathPenalty1
DeathPenalty
install.packages("cartography")
library(cartography)
install.packages("sf")
library(sf)
library(cartography)
install.packages("udunits2")
library(sf)
library(cartography)
library(udunits2)
(14*.0705-30*.0367)/(44*.0367)
(14*.0367-30*.0367)/(44*.0367)
(14-30)/(44)
(14*.159-30*.0367)/(44*.0367)
(14*.0705+30*.0367)/(44*.0367)
3*4
rm(list=ls())
library(cartography)
rootdir="C:/Users/Silvio/Documents/"
mapdir="ArcGIS Explorer/My Basemaps/MEX_adm/"
mapdir2="ArcGIS Explorer/My Basemaps/encuesta_intercensal_2015 Diego/encuesta_intercensal_2015/shps/yuc/"
setwd(paste0(rootdir,"GitHub/U-of-Florida-Yucatan-Project"))
##
urbana<- st_read(paste0(rootdir,mapdir2,"yuc_ageb_urbana.shp"),quiet=T)#encuesta intercensal
rural<-st_read(paste0(rootdir,mapdir2,"yuc_ageb_rural.shp"),quiet=T)#Encuesta intercensal
# View(encuesta)
head(urbana)
tail(urbana)
# View(encuesta)
View(urbana)
##############################################################################
#Poker example
pdf("E:\\sta6208\\poker_skill.pdf")
##############################################################################
#Poker example
pdf("C:Users/Silvio/Downloads/poker_skill.pdf")
poker <- read.table("http://www.stat.ufl.edu/~winner/data/poker_skill.dat",
header=F,col.names=c("skill","hand","limit","cash"))
attach(poker)
skill <- factor(skill); levels(skill) <- c("Expert", "Novice")
hand <- factor(hand); levels(hand) <- c("Bad","Neutral","Good")
limit <- factor(limit); levels(limit) <- c("Fixed","None")
View(poker)
View(poker)
# View(poker)
head(poker)
tail(poker)
poker[,200]
poker[200,]
(tapply(cash,list(skill,hand,limit),mean)); (tapply(cash,list(skill,hand),mean))
########################################################
#Car speed example
signspd <- read.csv("http://www.stat.ufl.edu/~winner/data/carspeed.csv")
attach(signspd); names(signspd)
interaction.plot(Trt,Subject,accelerate)
View(signspd)
